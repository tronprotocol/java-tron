package stest.tron.wallet.dailybuild.tvmnewcommand.multiValidateSignContract;

import io.grpc.ManagedChannel;
import io.grpc.ManagedChannelBuilder;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Optional;
import java.util.concurrent.TimeUnit;
import lombok.extern.slf4j.Slf4j;
import org.junit.Assert;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeSuite;
import org.testng.annotations.Test;
import org.tron.api.WalletGrpc;
import org.tron.api.WalletSolidityGrpc;
import org.tron.common.crypto.ECKey;
import org.tron.common.utils.ByteArray;
import org.tron.common.utils.Utils;
import org.tron.core.Wallet;
import org.tron.protos.Protocol.TransactionInfo;
import stest.tron.wallet.common.client.Configuration;
import stest.tron.wallet.common.client.Parameter;
import stest.tron.wallet.common.client.utils.AbiUtil;
import stest.tron.wallet.common.client.utils.PublicMethed;

@Slf4j
public class multiValidateSignContract012 {

  private final String testNetAccountKey = Configuration.getByPath("testng.conf")
      .getString("foundationAccount.key2");
  private final byte[] testNetAccountAddress = PublicMethed
      .getFinalAddress(testNetAccountKey);
  byte[] contractAddress = null;
  String txid;
  ECKey ecKey1 = new ECKey(Utils.getRandom());
  byte[] contractExcAddress = ecKey1.getAddress();
  String contractExcKey = ByteArray.toHexString(ecKey1.getPrivKeyBytes());
  private Long maxFeeLimit = Configuration.getByPath("testng.conf")
      .getLong("defaultParameter.maxFeeLimit");
  private ManagedChannel channelFull = null;
  private WalletGrpc.WalletBlockingStub blockingStubFull = null;
  private ManagedChannel channelFull1 = null;
  private WalletGrpc.WalletBlockingStub blockingStubFull1 = null;
  private WalletSolidityGrpc.WalletSolidityBlockingStub blockingStubSolidity = null;
  private String fullnode = Configuration.getByPath("testng.conf")
      .getStringList("fullnode.ip.list").get(0);
  private String fullnode1 = Configuration.getByPath("testng.conf")
      .getStringList("fullnode.ip.list").get(1);

  @BeforeSuite
  public void beforeSuite() {
    Wallet wallet = new Wallet();
    Wallet.setAddressPreFixByte(Parameter.CommonConstant.ADD_PRE_FIX_BYTE_MAINNET);
  }

  /**
   * constructor.
   */

  @BeforeClass(enabled = true)
  public void beforeClass() {
    PublicMethed.printAddress(contractExcKey);
    channelFull = ManagedChannelBuilder.forTarget(fullnode)
        .usePlaintext(true)
        .build();
    blockingStubFull = WalletGrpc.newBlockingStub(channelFull);
    channelFull1 = ManagedChannelBuilder.forTarget(fullnode1)
        .usePlaintext(true)
        .build();
    blockingStubFull1 = WalletGrpc.newBlockingStub(channelFull1);
    txid = PublicMethed
        .sendcoinGetTransactionId(contractExcAddress, 10000000000L, testNetAccountAddress,
            testNetAccountKey,
            blockingStubFull);
    PublicMethed.waitProduceNextBlock(blockingStubFull);
    String filePath = "framework/src/test/resources/soliditycode/multivalidatesign005.sol";
    String contractName = "Demo";
    HashMap retMap = PublicMethed.getBycodeAbi(filePath, contractName);
    String code = retMap.get("byteCode").toString();
    String abi = retMap.get("abI").toString();
    contractAddress = PublicMethed
        .deployContract(contractName, abi, code, "", maxFeeLimit,
            0L, 100, null, contractExcKey,
            contractExcAddress, blockingStubFull);
    PublicMethed.waitProduceNextBlock(blockingStubFull);
  }

  @Test(enabled = true, description = "Trigger precompile multivalisign function with correct data")
  public void test01TriggerPrecompileMultivalisignWithCorrectData() {
    String input = "d5d16b4c4a4143e94b3e9858440e462f2713a6b9a83e6da870a52efe84aa3aff00000000000"
        + "000000000000000000000000000000000000000000000000000600000000000000000000000000000000"
        + "000000000000000000000000000001160000000000000000000000000000000000000000000000000000"
        + "000000000001b00000000000000000000000000000000000000000000000000000000000003600000000"
        + "0000000000000000000000000000000000000000000000000000003e0000000000000000000000000000"
        + "000000000000000000000000000000000046000000000000000000000000000000000000000000000000"
        + "000000000000004e00000000000000000000000000000000000000000000000000000000000000560000"
        + "00000000000000000000000000000000000000000000000000000000005e000000000000000000000000"
        + "000000000000000000000000000000000000006600000000000000000000000000000000000000000000"
        + "0000000000000000006e0000000000000000000000000000000000000000000000000000000000000076"
        + "000000000000000000000000000000000000000000000000000000000000007e00000000000000000000"
        + "000000000000000000000000000000000000000000860000000000000000000000000000000000000000"
        + "00000000000000000000008e000000000000000000000000000000000000000000000000000000000000"
        + "0096000000000000000000000000000000000000000000000000000000000000009e0000000000000000"
        + "0000000000000000000000000000000000000000000000a6000000000000000000000000000000000000"
        + "00000000000000000000000000ae00000000000000000000000000000000000000000000000000000000"
        + "000000b600000000000000000000000000000000000000000000000000000000000000be000000000000"
        + "00000000000000000000000000000000000000000000000000c600000000000000000000000000000000"
        + "000000000000000000000000000000ce0000000000000000000000000000000000000000000000000000"
        + "0000000000d600000000000000000000000000000000000000000000000000000000000000de00000000"
        + "000000000000000000000000000000000000000000000000000000e60000000000000000000000000000"
        + "0000000000000000000000000000000000ee000000000000000000000000000000000000000000000000"
        + "00000000000000f600000000000000000000000000000000000000000000000000000000000000fe0000"
        + "000000000000000000000000000000000000000000000000000000000106000000000000000000000000"
        + "00000000000000000000000000000000000000041c2c9c4a053b541678dadc0c1e9b2bd39f01c3ba4d9d"
        + "0af816cfcb3db8b3aea957a5abc40ab60750a7059e0f107cd144744817d785e064b353d1fc3c6ac2d31f"
        + "b00000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000004129d03c7cfbf5aa67902645b02dc2a90322f7459"
        + "1e56a1d00b78cd9b9ce7bf42073e8eefb56c91172be0b93cd024da47eaff166bd3d6dbba68c10faee6f5"
        + "dcb920000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000041fb4f29f183442411d7028f0bcdfd47c0e55"
        + "263c2c6ab2f4f9270720b9dd8008d54be4b3e4a9471dbf72154f6ebaaf00b726c5053705a9dc34791b3b"
        + "a1701bb98000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000041fbd07c9b6059c280130a8b03ced7564"
        + "fd5abfd902b4ab272fce86c15d12b57e606a4aee370951feb6dffc0fc927481b08ebed68704ba75092a8"
        + "85e69233cbb2c00000000000000000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000041d0a30a8205952abd2328cc1a5f1"
        + "88e55a5e2aced4a5389296498f39663dc22d147ffc0970c9b21c8bb4880004387faa022c79e15830c04b"
        + "44811c7a82472a12f0100000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000041b31c374bf083607bd6db025"
        + "4be53e8c0478d6e8b5bc10353adbdef00a4465454766f707bf73395e55da2ae2b4872da2ba2ec1bd6fcf"
        + "c188b373b15e85f722d75010000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000000000000000041d5513a9c31adec99fba"
        + "d4a76b1417c11948ace07084f839a08d4cdc7bab94b5b268b21ee033cea0a660c4da902dfe0e075fcd71"
        + "8a60bdd76a56857957b2a2e7100000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000041f71258ae411cf44"
        + "9a78839ee04ae467d0a206f78f9d50e3ed6fcded9d6703abf18edf34b3e3d3530fc01f8c6e09e30d1ab2"
        + "9f498572b86e78b4350baaa6531310000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000004151d9db3dac5"
        + "cef1765cc12b78eeae1e96a6d60ca68e7ad0e3a80051a73ede40c2b1e01ab19daa015ce5722c3a44dfad"
        + "df7e2e795dde7bbd0e1aa6e0c2fc26d93000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000000000000000000000000000041a2109a5"
        + "a7ff76aa9d05f87700ddad9432219eed16ab1062408458d28fca5d3e47ba54b30ccf2c941c6eccb2cb43"
        + "03c04c08e14c8b6b6245dbf50469f886b1cbe00000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000041f1e"
        + "2189d77d8fec6bf5c6aba65e5ba310dd277e3c113b2e66d82b8aa169ae8492104b11c66ed9dffe63ee4c"
        + "71c31bfea6885e3f346054577a3ba1446d5524ae50100000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000004"
        + "1285579d737140b575e64e83a4ef9b58e51bf79f1358cb12da86191e32167682f19bf5147fa79bb03205"
        + "978d563b2614546c0c0ac2dd3c1c351d22cf22e024e6a010000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0004148a1f951d13bde3fba0d7bfadbb456aedbba03d14138a91f89b104ec596d1c7d142020fff15770a"
        + "34ac3d32af67ebe3e15fea627748329120e72766c300656a201000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000004147d1d146db88e3adb6687f1a32105ffa1a776396653dc95b16a2e3a138cf8f2e04c8de35a09"
        + "fec5404e2fe6440234454d74524a966fa9ceca9ef97240d907bd00100000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000041ca7f61abc790f644c7392809c3846c644e0064cb83a809e8b48dcad118e83cfa72b2e8d"
        + "1b502590f58878434418b46d3fd5b21dd11b03a88f9d9634c5d7208cf000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000041674d3705073fab7213e14e309bf2f6cc969a1a21aa6bf1fb423cc3a4203ea4ff27e"
        + "13bc0c31f1987cc1697238496b539d2e16e995deedebf90518e548674d57601000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000041fe01520c788a8535341a6cd76ca7f6feebe0f3e8793f125c3c427990868e5f9"
        + "442781f9d4decf5b91e3e91d08befac62d1ddf9b8f512abef32c18bf6e97cc8fe0000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000041b23a819b541d9667a5f610f6255fb28658243012d9219279855fb47683a"
        + "440de411698479e7a76c8eac9b5c4df09682c155bba41777dcda98482daf67b6c1217010000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000004120ab13f1892084bd1a29dd96509cfb9ab5b22ac508921445e5ea3d2"
        + "911490a326b85f7c2d6e70bc48a80b0aa587d6f1ee090d411487f5bd816c374bf3a19adb401000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000414aafb6f11665c899e63f322ff760703a7ec797fd6687c8566ea"
        + "89dcaff85a31d0b7d2bc48d400c8aceadd14d4f10d5009ddf99d58bf752bb08876580c506a9020100000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000041d586a449bf0066470eee778f246cbf674be3b918c060cfd"
        + "cef202fe866c58d9a298866246b5425cd826dc8afc021de24b5fa3235502497f7b982f295c69c1a5a000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000041f9d8112cb16d841484e89194eda6b28e4d90a4d6cd5"
        + "fb549e65698e27e4724546d82318b869380d6daeee24e48023de3257c79b5fac4888f8d714319665d49a"
        + "801000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000412a2e832330fc7d86ad33cc05c2f727b5e6b81b4"
        + "80ded5a8ab9f85b94e1b3de2364a6d6330e642e62a598d536a0f3b9cd2611ce785c1fbc433001db50b1f"
        + "0bca60100000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000041446dc24c56d09436254954a6b48d4bf80a9"
        + "ae63c7b482fe8a3327411f01f2c1e52aa0e165b03684e7ee85f8162ddd72a5072488ee9b7d574b33ca02"
        + "dc9f9a042000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000041bd9d98c95e0c07b1a99d35e10ab17ee"
        + "0b000591075d228795eb04e6158d955952c173aa7d3fb17465529970d37d5d31a29f5bbdc0eb9db059bb"
        + "6f9691cf3c0be00000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000419952389f1569fb2eece52f07deb"
        + "dee9dd7c7a5bc32cf262e439210e1a2dcc66426bc0e37f2269dbb2ebb76420b03bfc44402cea31309718"
        + "082156f192b3c802d0000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000041da876b090ce5abaa8b5ac8c"
        + "8bffa6a635efddef2ed504edf057a0001739974de20f26192626bc5fba0eb9d9aeafe23d6ac4f04c7e0b"
        + "ae900f191d1076c41f496000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000000001b0000000000000000000"
        + "00041ae03e886627da283b39d2db269f19d2d64a9fd0d000000000000000000000041c48eb14a6adb757"
        + "19847cb675fbb9e84db4fe2260000000000000000000000410f8aa70e13155452a74fd6741818001c3f0"
        + "149d00000000000000000000000418f7633f417d923d4e2a057cd826b01a9367db00c000000000000000"
        + "000000041eb7bb4a766d2934a123e38d5446c51e0ed8aad4a00000000000000000000004160e9b4bc2c6"
        + "5ba559dd4c18f5e7e882326b67842000000000000000000000041499b51fe33622ce34eed972b7bcda95"
        + "acb6b1cec000000000000000000000041963495e687eac79320d136f10e4e653160b7987500000000000"
        + "000000000004108cef9cd64c9ab4ca1eb5d38619cf0f67c89ac8a00000000000000000000004145668c6"
        + "485ecebfcfbe027dd5146127a9d98fd890000000000000000000000414931c50c04af9bc86db96560d78"
        + "97191baaf3f2e00000000000000000000004185dfd05780cbffec30fe8246b4ab52c7fbe8c7aa0000000"
        + "000000000000000412e4b9362ea76ad47bee9c3014e39ca6a950d02670000000000000000000000415cd"
        + "ea6b64defeedf16fa4f5bcddeb6bb41e1da270000000000000000000000419e8deb9d6dfe58b2c599296"
        + "0f14dceb89faf4ab9000000000000000000000041142e7f1e8369082ae624e62967018cc47d7ee1c0000"
        + "000000000000000000041ee1cce7c7b5e5cf53f3957d43a82a0b31f97093c00000000000000000000004"
        + "1fd51090879ceda93ef53de8d196a0b671f8e1267000000000000000000000041ec0ff8ebede8770fbc2"
        + "47f39837892b841714da6000000000000000000000041165b23284ed72b80cf4dc30caf31d746493f96a"
        + "4000000000000000000000041ded6eee99c0b7cca3d4144e317a9f1129f52619d0000000000000000000"
        + "0004136a95f7551e0f101e28716be3fe3ba8e9c9542cf000000000000000000000041107dee9ed97174f"
        + "6a9ae46cccd2f473c6c0f14c5000000000000000000000041627640bd8ee5fabb99fe4ccaed27c6bed89"
        + "cc5a0000000000000000000000041bbc3a4121e459b3f9233658bd559cbb97ac917e6000000000000000"
        + "000000041defc48154810f0b5c48cafa5c288b58c93ff80b4000000000000000000000041c615f786754"
        + "0ca9eb6d6d8c6795af8191167527f";

    String method = "testArray2(bytes)";
    AbiUtil.parseMethod(method, Arrays.asList(input));
    txid = PublicMethed.triggerContract(contractAddress,
        method, AbiUtil.parseParameters(method, Arrays.asList(input)), true,
        0, maxFeeLimit, contractExcAddress, contractExcKey, blockingStubFull);
    PublicMethed.getTransactionById(txid, blockingStubFull);
    PublicMethed.waitProduceNextBlock(blockingStubFull);
    Optional<TransactionInfo> infoById = null;
    infoById = PublicMethed.getTransactionInfoById(txid, blockingStubFull);
    Assert.assertEquals(0, infoById.get().getResultValue());
    logger
        .info(
            "infoById:" + ByteArray.toHexString(infoById.get().getContractResult(0).toByteArray()));
    Assert
        .assertTrue(ByteArray.toHexString(infoById.get().getContractResult(0).toByteArray()).equals(
            "0000000000000000000000000000000000000000000000000000000000000001"
                + "0000000000000000000000000000000000000000000000000000000000000040"
                + "0000000000000000000000000000000000000000000000000000000000000020"
                + "0101010101010101010101010101010101010101010101010101010000000000"));


  }

  @Test(enabled = true, description = "Trigger precompile multivalidatesign function with incor"
      + "rect data")
  public void test02TriggerPrecompileMultivalisignWithIncorrectData() {
    String input = "d5d16b4c4a4143e94b3e9858440e462f2713a6b9a83e6da870a52efe84aa3aff00000000000"
        + "000000000000000000000000000000000000000000000000000600000000000000000000000000000000"
        + "000000000000000000000000000001160000000000000000000000000000000000000000000000000000"
        + "000000000001b00000000000000000000000000000000000000000000000000000000000003600000000"
        + "0000000000000000000000000000000000000000000000000000003e0000000000000000000000000000"
        + "000000000000000000000000000000000046000000000000000000000000000000000000000000000000"
        + "000000000000004e00000000000000000000000000000000000000000000000000000000000000560000"
        + "00000000000000000000000000000000000000000000000000000000005e000000000000000000000000"
        + "000000000000000000000000000000000000006600000000000000000000000000000000000000000000"
        + "0000000000000000006e0000000000000000000000000000000000000000000000000000000000000076"
        + "000000000000000000000000000000000000000000000000000000000000007e00000000000000000000"
        + "000000000000000000000000000000000000000000860000000000000000000000000000000000000000"
        + "00000000000000000000008e000000000000000000000000000000000000000000000000000000000000"
        + "0096000000000000000000000000000000000000000000000000000000000000009e0000000000000000"
        + "0000000000000000000000000000000000000000000000a6000000000000000000000000000000000000"
        + "00000000000000000000000000ae00000000000000000000000000000000000000000000000000000000"
        + "000000b600000000000000000000000000000000000000000000000000000000000000be000000000000"
        + "00000000000000000000000000000000000000000000000000c600000000000000000000000000000000"
        + "000000000000000000000000000000ce0000000000000000000000000000000000000000000000000000"
        + "0000000000d600000000000000000000000000000000000000000000000000000000000000de00000000"
        + "000000000000000000000000000000000000000000000000000000e60000000000000000000000000000"
        + "0000000000000000000000000000000000ee000000000000000000000000000000000000000000000000"
        + "00000000000000f600000000000000000000000000000000000000000000000000000000000000fe0000"
        + "000000000000000000000000000000000000000000000000000000000106000000000000000000000000"
        + "00000000000000000000000000000000000000041c2c9c4a053b541678dadc0c1e9b2bd39f01c3ba4d9d"
        + "0af816cfcb3db8b3aea957a5abc40ab60750a7059e0f107cd144744817d785e064b353d1fc3c6ac2d31f"
        + "b00000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000004129d03c7cfbf5aa67902645b02dc2a90322f7459"
        + "1e56a1d00b78cd9b9ce7bf42073e8eefb56c91172be0b93cd024da47eaff166bd3d6dbba68c10faee6f5"
        + "dcb920000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000041fb4f29f183442411d7028f0bcdfd47c0e55"
        + "263c2c6ab2f4f9270720b9dd8008d54be4b3e4a9471dbf72154f5ebaaf00b726c5053705a9dc34791b3b"
        + "a1701bb98000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000041fbd07c9b6059c280130a8b03ced7564"
        + "fd5abfd902b4ab272fce86c15d12b57e606a4aee370951feb6dffc0fc927481b08ebed68704ba75092a8"
        + "85e69233cbb2c00000000000000000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000041d0a30a8205952abd2328cc1a5f1"
        + "88e55a5e2aced4a5389296498f39663dc22d147ffc0970c9b21c8bb4880004387faa022c79e15830c04b"
        + "44811c7a82472a12f0100000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000041b31c374bf083607bd6db025"
        + "4be53e8c0478d6e8b5bc10353adbdef00a4465454766f707bf73395e55da2ae2b4872da2ba2ec1bd6fcf"
        + "c188b373b15e85f722d75010000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000000000000000041d5513a9c31adec99fba"
        + "d4a76b1417c11948ace07084f839a08d4cdc7bab94b5b268b21ee033cea0a660c4da902dfe0e075fcd71"
        + "8a60bdd76a56857957b2a2e7100000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000041f71258ae411cf44"
        + "9a78839ee04ae467d0a206f78f9d50e3ed6fcded9d6703abf18edf34b3e3d3530fc01f8c6e09e30d1ab2"
        + "9f498572b86e78b4350baaa6531310000000000000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000004151d9db3dac5"
        + "cef1765cc12b78eeae1e96a6d60ca68e7ad0e3a80051a73ede40c2b1e01ab19daa015ce5722c3a44dfad"
        + "df7e2e795dde7bbd0e1aa6e0c2fc26d93000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000000000000000000000000000041a2109a5"
        + "a7ff76aa9d05f87700ddad9432219eed16ab1062408458d28fca5d3e47ba54b30ccf2c941c6eccb2cb43"
        + "03c04c08e14c8b6b6245dbf50469f886b1cbe00000000000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000041f1e"
        + "2189d77d8fec6bf5c6aba65e5ba310dd277e3c113b2e66d82b8aa169ae8492104b11c66ed9dffe63ee4c"
        + "71c31bfea6885e3f346054577a3ba1446d5524ae50100000000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000004"
        + "1285579d737140b575e64e83a4ef9b58e51bf79f1358cb12da86191e32167682f19bf5147fa79bb03205"
        + "978d563b2614546c0c0ac2dd3c1c351d22cf22e024e6a010000000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0004148a1f951d13bde3fba0d7bfadbb456aedbba03d14138a91f89b104ec596d1c7d142020fff15770a"
        + "34ac3d32af67ebe3e15fea627748329120e72766c300656a201000000000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000004147d1d146db88e3adb6687f1a32105ffa1a776396653dc95b16a2e3a138cf8f2e04c8de35a09"
        + "fec5404e2fe6440234454d74524a966fa9ceca9ef97240d907bd00100000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000041ca7f61abc790f644c7392809c3846c644e0064cb83a809e8b48dcad118e83cfa72b2e8d"
        + "1b502590f58878434418b46d3fd5b21dd11b03a88f9d9634c5d7208cf000000000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000041674d3705073fab7213e14e309bf2f6cc969a1a21aa6bf1fb423cc3a4203ea4ff27e"
        + "13bc0c31f1987cc1697238496b539d2e16e995deedebf90518e548674d57601000000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "000000000000000000041fe01520c788a8535341a6cd76ca7f6feebe0f3e8793f125c3c427990868e5f9"
        + "442781f9d4decf5b91e3e91d08befac62d1ddf9b8f512abef32c18bf6e97cc8fe0000000000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000041b23a819b541d9667a5f610f6255fb28658243012d9219279855fb47683a"
        + "440de411698479e7a76c8eac9b5c4df09682c155bba41777dcda98482daf67b6c1217010000000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000004120ab13f1892084bd1a29dd96509cfb9ab5b22ac508921445e5ea3d2"
        + "911490a326b85f7c2d6e70bc48a80b0aa587d6f1ee090d411487f5bd816c374bf3a19adb401000000000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000414aafb6f11665c899e63f322ff760703a7ec797fd6687c8566ea"
        + "89dcaff85a31d0b7d2bc48d400c8aceadd14d4f10d5009ddf99d58bf752bb08876580c506a9020100000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000041d586a449bf0066470eee778f246cbf674be3b918c060cfd"
        + "cef202fe866c58d9a298866246b5425cd826dc8afc021de24b5fa3235502497f7b982f295c69c1a5a000"
        + "000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000041f9d8112cb16d841484e89194eda6b28e4d90a4d6cd5"
        + "fb549e65698e27e4724546d82318b869380d6daeee24e48023de3257c79b5fac4888f8d714319665d49a"
        + "801000000000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000412a2e832330fc7d86ad33cc05c2f727b5e6b81b4"
        + "80ded5a8ab9f85b94e1b3de2364a6d6330e642e62a598d536a0f3b9cd2611ce785c1fbc433001db50b1f"
        + "0bca60100000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000041446dc24c56d09436254954a6b48d4bf80a9"
        + "ae63c7b482fe8a3327411f01f2c1e52aa0e165b03684e7ee85f8162ddd72a5072488ee9b7d574b33ca02"
        + "dc9f9a042000000000000000000000000000000000000000000000000000000000000000000000000000"
        + "00000000000000000000000000000000000000000000000000041bd9d98c95e0c07b1a99d35e10ab17ee"
        + "0b000591075d228795eb04e6158d955952c173aa7d3fb17465529970d37d5d31a29f5bbdc0eb9db059bb"
        + "6f9691cf3c0be00000000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000419952389f1569fb2eece52f07deb"
        + "dee9dd7c7a5bc32cf262e439210e1a2dcc66426bc0e37f2269dbb2ebb76420b03bfc44402cea31309718"
        + "082156f192b3c802d0000000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000041da876b090ce5abaa8b5ac8c"
        + "8bffa6a635efddef2ed504edf057a0001739974de20f26192626bc5fba0eb9d9aeafe23d6ac4f04c7e0b"
        + "ae900f191d1076c41f496000000000000000000000000000000000000000000000000000000000000000"
        + "0000000000000000000000000000000000000000000000000000000000000001b0000000000000000000"
        + "00041ae03e886627da283b39d2db269f19d2d64a9fd0d000000000000000000000041c48eb14a6adb757"
        + "19847cb675fbb9e84db4fe2260000000000000000000000410f8aa70e13155452a74fd6741818001c3f0"
        + "149d00000000000000000000000418f7633f417d923d4e2a057cd826b01a9367db00c000000000000000"
        + "000000041eb7bb4a766d2934a123e38d5446c51e0ed8aad4a00000000000000000000004160e9b4bc2c6"
        + "5ba559dd4c18f5e7e882326b67842000000000000000000000041499b51fe33622ce34eed972b7bcda95"
        + "acb6b1cec000000000000000000000041963495e687eac79320d136f10e4e653160b7987500000000000"
        + "000000000004108cef9cd64c9ab4ca1eb5d38619cf0f67c89ac8a00000000000000000000004145668c6"
        + "485ecebfcfbe027dd5146127a9d98fd890000000000000000000000414931c50c04af9bc86db96560d78"
        + "97191baaf3f2e00000000000000000000004185dfd05780cbffec30fe8246b4ab52c7fbe8c7aa0000000"
        + "000000000000000412e4b9362ea76ad47bee9c3014e39ca6a950d02670000000000000000000000415cd"
        + "ea6b64defeedf16fa4f5bcddeb6bb41e1da270000000000000000000000419e8deb9d6dfe58b2c599296"
        + "0f14dceb89faf4ab9000000000000000000000041142e7f1e8369082ae624e62967018cc47d7ee1c0000"
        + "000000000000000000041ee1cce7c7b5e5cf53f3957d43a82a0b31f97093c00000000000000000000004"
        + "1fd51090879ceda93ef53de8d196a0b671f8e1267000000000000000000000041ec0ff8ebede8770fbc2"
        + "47f39837892b841714da6000000000000000000000041165b23284ed72b80cf4dc30caf31d746493f96a"
        + "4000000000000000000000041ded6eee99c0b7cca3d4144e317a9f1129f52619d0000000000000000000"
        + "0004136a95f7551e0f101e28716be3fe3ba8e9c9542cf000000000000000000000041107dee9ed97174f"
        + "6a9ae46cccd2f473c6c0f14c5000000000000000000000041627640bd8ee5fabb99fe4ccaed27c6bed89"
        + "cc5a0000000000000000000000041bbc3a4121e459b3f9233658bd559cbb97ac917e6000000000000000"
        + "000000041defc48154810f0b5c48cafa5c288b58c93ff80b4000000000000000000000041c615f786754"
        + "0ca9eb6d6d8c6795af8191167527f";

    String method = "testArray2(bytes)";
    AbiUtil.parseMethod(method, Arrays.asList(input));
    txid = PublicMethed.triggerContract(contractAddress,
        method, AbiUtil.parseParameters(method, Arrays.asList(input)), true,
        0, maxFeeLimit, contractExcAddress, contractExcKey, blockingStubFull);
    PublicMethed.getTransactionById(txid, blockingStubFull);
    PublicMethed.waitProduceNextBlock(blockingStubFull);
    Optional<TransactionInfo> infoById = null;
    infoById = PublicMethed.getTransactionInfoById(txid, blockingStubFull);
    Assert.assertEquals(0, infoById.get().getResultValue());
    logger
        .info(
            "infoById:" + ByteArray.toHexString(infoById.get().getContractResult(0).toByteArray()));
    Assert
        .assertTrue(ByteArray.toHexString(infoById.get().getContractResult(0).toByteArray()).equals(
            "0000000000000000000000000000000000000000000000000000000000000001"
                + "0000000000000000000000000000000000000000000000000000000000000040"
                + "0000000000000000000000000000000000000000000000000000000000000020"
                + "0101000101010101010101010101010101010101010101010101010000000000"));
  }

  /**
   * constructor.
   */
  @AfterClass
  public void shutdown() throws InterruptedException {
    long balance = PublicMethed.queryAccount(contractExcKey, blockingStubFull)
        .getBalance();
    PublicMethed
        .sendcoin(testNetAccountAddress, balance, contractExcAddress, contractExcKey,
            blockingStubFull);
    if (channelFull != null) {
      channelFull.shutdown().awaitTermination(5, TimeUnit.SECONDS);
    }
    if (channelFull1 != null) {
      channelFull1.shutdown().awaitTermination(5, TimeUnit.SECONDS);
    }
  }

}
